{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}">
{% endblock %}

{% block content %}
    <!-- Header -->
    <header class="header" role="banner" aria-label="Main header">
        <div class="logo">
            <div class="logo-icon" aria-hidden="true">
                <i class="fas fa-network-wired"></i>
            </div>
            <div class="logo-text">
                <h1>ContactFlow Pro</h1>
            </div>
        </div>
    </header>

    <!-- Breadcrumb -->
    <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="/" class="breadcrumb-item active">
            <i class="fas fa-home" aria-hidden="true"></i>
            Dashboard
        </a>
    </nav>

    <!-- Main Content -->
    <main id="main-content" role="main">
        <!-- Stats Section -->
        <section class="stats-bar" aria-label="System statistics">
            <div class="stat-item">
                <div class="stat-number" id="contactsCount" aria-live="polite">0</div>
                <div class="stat-label">Total Contacts</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="departmentsCount" aria-live="polite">0</div>
                <div class="stat-label">Departments</div>
            </div>
        </section>

        <!-- Features Grid -->
        <section class="main-grid" aria-label="Application features">
            <div class="feature-cards">
                <div class="feature-card" role="button" tabindex="0"
                     onclick="window.location.href='/contacts'"
                     onkeydown="handleFeatureCardKey(event, '/contacts')"
                     aria-label="Contacts Management - Manage your contact database with advanced filtering, status tracking, and CV management">
                    <div class="card-icon" aria-hidden="true">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="card-content">
                        <h3>Contacts Management</h3>
                        <p>Manage your entire contact database with advanced filtering, status tracking, and CV management.</p>
                    </div>
                </div>

                <div class="feature-card" role="button" tabindex="0"
                     onclick="window.location.href='/departments'"
                     onkeydown="handleFeatureCardKey(event, '/departments')"
                     aria-label="Departments Management - Organize your structure with departments and track assignments">
                    <div class="card-icon" aria-hidden="true">
                        <i class="fas fa-sitemap"></i>
                    </div>
                    <div class="card-content">
                        <h3>Departments</h3>
                        <p>Organize your structure with departments and track assignments across your organization.</p>
                    </div>
                </div>

                <div class="feature-card" role="button" tabindex="0"
                     onclick="window.location.href='/assignments'"
                     onkeydown="handleFeatureCardKey(event, '/assignments')"
                     aria-label="Assignments Management - Assign contacts to departments with intelligent tracking">
                    <div class="card-icon" aria-hidden="true">
                        <i class="fas fa-link"></i>
                    </div>
                    <div class="card-content">
                        <h3>Smart Assignments</h3>
                        <p>Assign contacts to departments and manage relationships with intelligent tracking.</p>
                    </div>
                </div>

                <div class="feature-card" role="button" tabindex="0"
                     onclick="showImportExport()"
                     onkeydown="handleFeatureCardKey(event, 'import')"
                     aria-label="Data Operations - Export reports and import data with advanced management tools">
                    <div class="card-icon" aria-hidden="true">
                        <i class="fas fa-database"></i>
                    </div>
                    <div class="card-content">
                        <h3>Data Operations</h3>
                        <p>Export comprehensive reports or import data with our advanced data management tools.</p>
                    </div>
                </div>
            </div>

            <!-- Stats Overview -->
            <section class="stats-overview" aria-label="System overview statistics">
                <h2><i class="fas fa-chart-bar" aria-hidden="true"></i> System Overview</h2>
                <div class="stat-chart">
                    <div class="stat-row" aria-label="Contacts statistics">
                        <div class="stat-info">
                            <div class="stat-color contacts" aria-hidden="true"></div>
                            <span>Contacts</span>
                        </div>
                        <div class="stat-bar">
                            <div class="stat-progress contacts" role="progressbar"
                                 aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <div class="stat-value" id="statContacts">0</div>
                    </div>
                    <div class="stat-row" aria-label="Departments statistics">
                        <div class="stat-info">
                            <div class="stat-color departments" aria-hidden="true"></div>
                            <span>Departments</span>
                        </div>
                        <div class="stat-bar">
                            <div class="stat-progress departments" role="progressbar"
                                 aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <div class="stat-value" id="statDepartments">0</div>
                    </div>
                    <div class="stat-row" aria-label="Active contacts statistics">
                        <div class="stat-info">
                            <div class="stat-color active" aria-hidden="true"></div>
                            <span>Active Contacts</span>
                        </div>
                        <div class="stat-bar">
                            <div class="stat-progress active" role="progressbar"
                                 aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <div class="stat-value" id="statActive">0%</div>
                    </div>
                </div>
            </section>

            <!-- Quick Actions -->
            <section class="quick-actions" aria-label="Quick actions">
                <h2><i class="fas fa-bolt" aria-hidden="true"></i> Quick Actions</h2>
                <nav class="action-buttons" aria-label="Action buttons">
                    <a href="/contacts" class="action-btn" aria-label="Add new contact">
                        <i class="fas fa-plus" aria-hidden="true"></i> Add New Contact
                    </a>
                    <a href="/departments" class="action-btn" aria-label="Create new department">
                        <i class="fas fa-folder-plus" aria-hidden="true"></i> Create Department
                    </a>
                    <a href="/assignments" class="action-btn" aria-label="Create new assignment">
                        <i class="fas fa-user-plus" aria-hidden="true"></i> New Assignment
                    </a>
                    <button class="action-btn secondary" onclick="window.location.href='/export'"
                            aria-label="Export all data to Excel file">
                        <i class="fas fa-download" aria-hidden="true"></i> Export Data
                    </button>
                    <button class="action-btn secondary" onclick="showImportModal()"
                            aria-label="Import data from Excel file">
                        <i class="fas fa-upload" aria-hidden="true"></i> Import Data
                    </button>
                    <button class="action-btn secondary" onclick="refreshDashboard()"
                            aria-label="Refresh dashboard data">
                        <i class="fas fa-sync-alt" aria-hidden="true"></i> Refresh
                    </button>
                </nav>
            </section>

        </section>
    </main>

    <!-- Import Modal -->
    <div id="importModal" role="dialog" aria-labelledby="importModalTitle" aria-modal="true" aria-hidden="true">
        <div class="modal-content">
            <h3 id="importModalTitle" style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-upload" aria-hidden="true"></i> Import Data
            </h3>
            <form id="importForm" enctype="multipart/form-data" style="display: flex; flex-direction: column; gap: 15px;">
                <label for="importFile" style="font-size: 14px; margin-bottom: 5px; color: var(--light);">
                    Select Excel file to import:
                </label>
                <input type="file" name="file" id="importFile" accept=".xlsx"
                       aria-required="true"
                       style="padding: 12px; border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; background: rgba(255,255,255,0.05); color: var(--light);">
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" onclick="hideImportModal()"
                            aria-label="Cancel import operation"
                            style="padding: 10px 20px; border: 1px solid rgba(255,255,255,0.2); background: transparent; color: var(--light); border-radius: 8px; cursor: pointer;">
                        Cancel
                    </button>
                    <button type="submit"
                            aria-label="Confirm and import selected file"
                            style="padding: 10px 20px; background: var(--primary); border: none; color: white; border-radius: 8px; cursor: pointer;">
                        Import
                    </button>
                </div>
            </form>
        </div>
    </div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='dashboard.js') }}"></script>
{% endblock %}